import{s as K,c as Q,o as W,b as X,n as I,d as Z}from"../chunks/scheduler.BWOwpdHh.js";import{S as $,i as ee,e as p,s as H,v as te,c as _,d as c,m as A,a as D,n as L,w as h,q as m,b as P,f as j,h as le,t as F,g as ae,j as re,l as se,p as ne,u as oe,H as ie,B as ce,k as q,o as U,r as ue,x as N,y as fe}from"../chunks/index.MrXRJrN0.js";import{h as me,u as de,e as B}from"../chunks/each.MqN4OFCs.js";import{g as he}from"../chunks/globals.D0QH3NT1.js";import{g as pe}from"../chunks/entry.CvtO8IbG.js";import{U as _e}from"../chunks/UserProfile.B1rVnCIF.js";import{u as ve}from"../chunks/stores.C_hhX81d.js";import{a as Y}from"../chunks/api.CI0u685j.js";const{document:V}=he;function G(o,l,r){const t=o.slice();return t[9]=l[r],t}function be(o){let l,r="You are not connected",t,e,n='<li><a href="/login">Login</a></li>';return{c(){l=p("p"),l.textContent=r,t=H(),e=p("ul"),e.innerHTML=n},l(a){l=_(a,"P",{"data-svelte-h":!0}),L(l)!=="svelte-xpjzu7"&&(l.textContent=r),t=A(a),e=_(a,"UL",{"data-svelte-h":!0}),L(e)!=="svelte-ejvyc0"&&(e.innerHTML=n)},m(a,d){P(a,l,d),P(a,t,d),P(a,e,d)},p:I,i:I,o:I,d(a){a&&(c(l),c(t),c(e))}}}function ge(o){let l,r,t,e,n,a,d='<h2>Update</h2> <div class="controls svelte-156mf8b"><div class="control svelte-156mf8b"><label for="file" class="svelte-156mf8b">Avatar :</label> <input type="file" class="input-file" name="file" id="file" accept="image/png, image/jpeg, image/gif"/></div> <div class="control svelte-156mf8b"><label for="file" class="svelte-156mf8b">Username :</label> <input type="text" name="username" id="username" placeholder="Set a new username" autocomplete="off"/></div></div> <button id="submit" class="svelte-156mf8b">Update</button>',v,k,b,E="My characters",g,u,C,y=o[0]&&O(o),f=o[1]&&R(o);e=new _e({props:{user:o[3]}});let w={ctx:o,current:null,token:null,hasCatch:!1,pending:Ee,then:ye,catch:ke,value:8};return me(o[4](),w),{c(){y&&y.c(),l=H(),f&&f.c(),r=H(),t=p("div"),re(e.$$.fragment),n=H(),a=p("form"),a.innerHTML=d,v=H(),k=p("div"),b=p("h2"),b.textContent=E,g=H(),u=p("div"),w.block.c(),this.h()},l(s){y&&y.l(s),l=A(s),f&&f.l(s),r=A(s),t=_(s,"DIV",{class:!0});var i=D(t);se(e.$$.fragment,i),n=A(i),a=_(i,"FORM",{id:!0,class:!0,"data-svelte-h":!0}),L(a)!=="svelte-111zpai"&&(a.innerHTML=d),i.forEach(c),v=A(s),k=_(s,"DIV",{class:!0});var M=D(k);b=_(M,"H2",{"data-svelte-h":!0}),L(b)!=="svelte-l0qx6s"&&(b.textContent=E),g=A(M),u=_(M,"DIV",{class:!0});var T=D(u);w.block.l(T),T.forEach(c),M.forEach(c),this.h()},h(){h(a,"id","update-form"),h(a,"class","box svelte-156mf8b"),h(t,"class","inline svelte-156mf8b"),h(u,"class","characters svelte-156mf8b"),h(k,"class","my-characters-box svelte-156mf8b")},m(s,i){y&&y.m(s,i),P(s,l,i),f&&f.m(s,i),P(s,r,i),P(s,t,i),ne(e,t,null),m(t,n),m(t,a),o[5](a),P(s,v,i),P(s,k,i),m(k,b),m(k,g),m(k,u),w.block.m(u,w.anchor=null),w.mount=()=>u,w.anchor=null,C=!0},p(s,i){o=s,o[0]?y?y.p(o,i):(y=O(o),y.c(),y.m(l.parentNode,l)):y&&(y.d(1),y=null),o[1]?f?f.p(o,i):(f=R(o),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null);const M={};i&8&&(M.user=o[3]),e.$set(M),de(w,o,i)},i(s){C||(F(e.$$.fragment,s),C=!0)},o(s){j(e.$$.fragment,s),C=!1},d(s){s&&(c(l),c(r),c(t),c(v),c(k)),y&&y.d(s),f&&f.d(s),oe(e),o[5](null),w.block.d(),w.token=null,w=null}}}function O(o){let l,r,t;return{c(){l=p("div"),r=p("p"),t=new ie(!1),this.h()},l(e){l=_(e,"DIV",{class:!0});var n=D(l);r=_(n,"P",{});var a=D(r);t=ce(a,!1),a.forEach(c),n.forEach(c),this.h()},h(){t.a=null,h(l,"class","success alert svelte-156mf8b")},m(e,n){P(e,l,n),m(l,r),t.m(o[0],r)},p(e,n){n&1&&t.p(e[0])},d(e){e&&c(l)}}}function R(o){let l,r,t;return{c(){l=p("div"),r=p("p"),t=q(o[1]),this.h()},l(e){l=_(e,"DIV",{class:!0});var n=D(l);r=_(n,"P",{});var a=D(r);t=U(a,o[1]),a.forEach(c),n.forEach(c),this.h()},h(){h(l,"class","error alert svelte-156mf8b")},m(e,n){P(e,l,n),m(l,r),m(r,t)},p(e,n){n&2&&ue(t,e[1])},d(e){e&&c(l)}}}function ke(o){return{c:I,l:I,m:I,p:I,d:I}}function ye(o){let l,r=B(o[8]),t=[];for(let e=0;e<r.length;e+=1)t[e]=J(G(o,r,e));return{c(){for(let e=0;e<t.length;e+=1)t[e].c();l=N()},l(e){for(let n=0;n<t.length;n+=1)t[n].l(e);l=N()},m(e,n){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,n);P(e,l,n)},p(e,n){if(n&16){r=B(e[8]);let a;for(a=0;a<r.length;a+=1){const d=G(e,r,a);t[a]?t[a].p(d,n):(t[a]=J(d),t[a].c(),t[a].m(l.parentNode,l))}for(;a<t.length;a+=1)t[a].d(1);t.length=r.length}},d(e){e&&c(l),fe(t,e)}}}function J(o){let l,r,t,e,n=o[9].name+"",a,d,v,k,b,E,g,u,C,y=o[9].name+"",f,w;return{c(){l=p("div"),r=p("div"),t=p("div"),e=p("h3"),a=q(n),d=H(),v=p("a"),k=q("Page"),b=H(),E=p("img"),u=H(),C=p("a"),f=q(y),w=H(),this.h()},l(s){l=_(s,"DIV",{class:!0});var i=D(l);r=_(i,"DIV",{class:!0});var M=D(r);t=_(M,"DIV",{class:!0});var T=D(t);e=_(T,"H3",{class:!0});var S=D(e);a=U(S,n),S.forEach(c),d=A(T),v=_(T,"A",{href:!0,id:!0});var x=D(v);k=U(x,"Page"),x.forEach(c),T.forEach(c),b=A(M),E=_(M,"IMG",{src:!0,alt:!0,class:!0}),M.forEach(c),u=A(i),C=_(i,"A",{href:!0});var z=D(C);f=U(z,y),z.forEach(c),w=A(i),i.forEach(c),this.h()},h(){h(e,"class","name"),h(v,"href",`/${o[9].code}`),h(v,"id","go"),h(t,"class","block"),Z(E.src,g=o[9].icon)||h(E,"src",g),h(E,"alt",""),h(E,"class","icon svelte-156mf8b"),h(r,"class","inline svelte-156mf8b"),h(C,"href",`/${o[9].code}`),h(l,"class","box svelte-156mf8b")},m(s,i){P(s,l,i),m(l,r),m(r,t),m(t,e),m(e,a),m(t,d),m(t,v),m(v,k),m(r,b),m(r,E),m(l,u),m(l,C),m(C,f),m(l,w)},p:I,d(s){s&&c(l)}}}function Ee(o){return{c:I,l:I,m:I,p:I,d:I}}function Me(o){let l,r,t,e,n,a,d,v,k,b="My Profile",E,g,u,C;const y=[ge,be],f=[];function w(s,i){return s[3]?0:1}return g=w(o),u=f[g]=y[g](o),{c(){l=p("meta"),r=p("meta"),t=p("meta"),e=p("meta"),n=p("meta"),a=H(),d=p("main"),v=p("div"),k=p("h1"),k.textContent=b,E=H(),u.c(),this.h()},l(s){const i=te("svelte-103wdwc",V.head);l=_(i,"META",{name:!0,content:!0}),r=_(i,"META",{name:!0,content:!0}),t=_(i,"META",{property:!0,content:!0}),e=_(i,"META",{property:!0,content:!0}),n=_(i,"META",{property:!0,content:!0}),i.forEach(c),a=A(s),d=_(s,"MAIN",{});var M=D(d);v=_(M,"DIV",{class:!0});var T=D(v);k=_(T,"H1",{"data-svelte-h":!0}),L(k)!=="svelte-bjixez"&&(k.textContent=b),E=A(T),u.l(T),T.forEach(c),M.forEach(c),this.h()},h(){V.title="Persona - My Profile",h(l,"name","author"),h(l,"content","Persona DB - My Profile"),h(r,"name","description"),h(r,"content","Find and host any original characters"),h(t,"property","og:title"),h(t,"content","Persona DB"),h(e,"property","og:description"),h(e,"content","Find and host any original characters"),h(n,"property","og:image"),h(n,"content","https://persona-db.xyz/favicon.png"),h(v,"class","container")},m(s,i){m(V.head,l),m(V.head,r),m(V.head,t),m(V.head,e),m(V.head,n),P(s,a,i),P(s,d,i),m(d,v),m(v,k),m(v,E),f[g].m(v,null),C=!0},p(s,[i]){let M=g;g=w(s),g===M?f[g].p(s,i):(ae(),j(f[M],1,1,()=>{f[M]=null}),le(),u=f[g],u?u.p(s,i):(u=f[g]=y[g](s),u.c()),F(u,1),u.m(v,null))},i(s){C||(F(u),C=!0)},o(s){j(u),C=!1},d(s){s&&(c(a),c(d)),c(l),c(r),c(t),c(e),c(n),f[g].d()}}}function Ce(o,l,r){let t;Q(o,ve,b=>r(3,t=b));let e="",n="";function a(b){r(1,n=b),setTimeout(()=>{r(1,n="")},3e3)}let d;W(()=>{if(!d)return;let b=d.querySelector("#submit");d.addEventListener("submit",E=>{E.preventDefault()}),b.addEventListener("click",async E=>{let g=new FormData(d);if(!g.get("username")&&!g.get("file"))a("You must provide username or avatar");else try{let u=await Y.updateMe(g);r(0,e=u.message),r(1,n=""),await pe("/")}catch(u){r(0,e=""),a(u.response.message),console.log(u);let C=document.querySelector("#username");C.value=""}})});async function v(){return(await Y.getCharacters()).filter(E=>E.ownerId===t._id)}function k(b){X[b?"unshift":"push"](()=>{d=b,r(2,d)})}return[e,n,d,t,v,k]}class Le extends ${constructor(l){super(),ee(this,l,Ce,Me,K,{})}}export{Le as component};
