import{s as nt,b as oe,a as ve,r as lt,n as Ye,d as he}from"../chunks/scheduler.BWOwpdHh.js";import{S as at,i as it,s as g,e as d,v as rt,d as m,m as b,c as _,a as k,w as o,b as L,q as f,t as V,f as M,h as Be,z as ge,j as be,n as x,l as ke,p as we,A as ne,g as Pe,u as ye,k as Ze,o as xe,r as et}from"../chunks/index.MrXRJrN0.js";import{g as Je}from"../chunks/entry.CvtO8IbG.js";import"../chunks/stores.C_hhX81d.js";import{M as ot,S as ut,T as tt}from"../chunks/MarkdownEditor.D6F6XuEz.js";import{a as Ue}from"../chunks/api.CI0u685j.js";function ct({params:l}){return l}const It=Object.freeze(Object.defineProperty({__proto__:null,load:ct},Symbol.toStringTag,{value:"Module"}));function Ke(l){let e,a,n,r,s,t,c,u,Q="Edit",A,S,le,ae,W,ie,j,I,E,p,F="Icon",N,U,z,C,Ee,Ce,D,X,Ae="Refsheet",Ie,De,Le,R,Te,ue,Y,G,q,ee,Me="Stats",$e,Ve,O,te,Re="Tags",Se,T,$,re,Ne,qe,w=l[0]&&Qe(l),y=l[1]&&We(l);function st(i){l[10](i)}let Oe={};l[4].description!==void 0&&(Oe.markdown=l[4].description),S=new ot({props:Oe}),oe.push(()=>ge(S,"markdown",st));function je(i,h){return i[4].icon?dt:ft}let ce=je(l),B=ce(l);function Fe(i,h){return i[4].refsheet?mt:_t}let fe=Fe(l),P=fe(l),v=l[4]&&l[4].stats&&Xe(l);const ze=[ht,pt],H=[];function Ge(i,h){return i[4]&&i[4].tags?0:1}return T=Ge(l),$=H[T]=ze[T](l),{c(){w&&w.c(),e=g(),y&&y.c(),a=g(),n=d("div"),r=d("div"),s=d("input"),c=g(),u=d("button"),u.textContent=Q,A=g(),be(S.$$.fragment),ae=g(),W=d("div"),ie=g(),j=d("div"),I=d("form"),E=d("div"),p=d("label"),p.textContent=F,N=g(),U=d("br"),z=g(),C=d("input"),Ee=g(),B.c(),Ce=g(),D=d("div"),X=d("label"),X.textContent=Ae,Ie=g(),De=d("br"),Le=g(),R=d("input"),Te=g(),P.c(),ue=g(),Y=d("div"),G=d("div"),q=d("div"),ee=d("h3"),ee.textContent=Me,$e=g(),v&&v.c(),Ve=g(),O=d("div"),te=d("h3"),te.textContent=Re,Se=g(),$.c(),this.h()},l(i){w&&w.l(i),e=b(i),y&&y.l(i),a=b(i),n=_(i,"DIV",{class:!0});var h=k(n);r=_(h,"DIV",{class:!0});var Z=k(r);s=_(Z,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,autocomplete:!0,class:!0}),c=b(Z),u=_(Z,"BUTTON",{"data-svelte-h":!0}),x(u)!=="svelte-h0ynbm"&&(u.textContent=Q),Z.forEach(m),A=b(h),ke(S.$$.fragment,h),ae=b(h),W=_(h,"DIV",{id:!0}),k(W).forEach(m),ie=b(h),j=_(h,"DIV",{class:!0});var se=k(j);I=_(se,"FORM",{action:!0,class:!0,method:!0,id:!0});var de=k(I);E=_(de,"DIV",{class:!0});var J=k(E);p=_(J,"LABEL",{for:!0,"data-svelte-h":!0}),x(p)!=="svelte-16b1hwa"&&(p.textContent=F),N=b(J),U=_(J,"BR",{}),z=b(J),C=_(J,"INPUT",{type:!0,name:!0,id:!0,max:!0,class:!0}),Ee=b(J),B.l(J),J.forEach(m),Ce=b(de),D=_(de,"DIV",{class:!0});var K=k(D);X=_(K,"LABEL",{for:!0,"data-svelte-h":!0}),x(X)!=="svelte-1ahd2x6"&&(X.textContent=Ae),Ie=b(K),De=_(K,"BR",{}),Le=b(K),R=_(K,"INPUT",{type:!0,name:!0,id:!0,max:!0,class:!0}),Te=b(K),P.l(K),K.forEach(m),de.forEach(m),se.forEach(m),h.forEach(m),ue=b(i),Y=_(i,"DIV",{class:!0});var He=k(Y);G=_(He,"DIV",{class:!0});var _e=k(G);q=_(_e,"DIV",{class:!0});var me=k(q);ee=_(me,"H3",{"data-svelte-h":!0}),x(ee)!=="svelte-5zwsxb"&&(ee.textContent=Me),$e=b(me),v&&v.l(me),me.forEach(m),Ve=b(_e),O=_(_e,"DIV",{class:!0});var pe=k(O);te=_(pe,"H3",{"data-svelte-h":!0}),x(te)!=="svelte-1nl40cx"&&(te.textContent=Re),Se=b(pe),$.l(pe),pe.forEach(m),_e.forEach(m),He.forEach(m),this.h()},h(){o(s,"type","text"),o(s,"name","name"),o(s,"id","name"),o(s,"placeholder","Give a name to the character"),o(s,"autocomplete","off"),s.value=t=l[4].name,o(s,"class","svelte-nbk2og"),o(r,"class","inline-name svelte-nbk2og"),o(W,"id","editorjs"),o(p,"for","icon"),o(C,"type","file"),o(C,"name","icon"),o(C,"id","icon"),o(C,"max","1"),C.hidden=!0,o(C,"class","svelte-nbk2og"),o(E,"class","setting-icon"),o(X,"for","refsheet"),o(R,"type","file"),o(R,"name","refsheet"),o(R,"id","refsheet"),o(R,"max","1"),R.hidden=!0,o(R,"class","svelte-nbk2og"),o(D,"class","setting-refsheet svelte-nbk2og"),o(I,"action",""),o(I,"class","images-form svelte-nbk2og"),o(I,"method","put"),o(I,"id","images-form"),o(j,"class","images-corner svelte-nbk2og"),o(n,"class","box svelte-nbk2og"),o(q,"class","stats-box svelte-nbk2og"),o(O,"class","tag-box svelte-nbk2og"),o(G,"class","inline svelte-nbk2og"),o(Y,"class","box svelte-nbk2og")},m(i,h){w&&w.m(i,h),L(i,e,h),y&&y.m(i,h),L(i,a,h),L(i,n,h),f(n,r),f(r,s),f(r,c),f(r,u),f(n,A),we(S,n,null),f(n,ae),f(n,W),f(n,ie),f(n,j),f(j,I),f(I,E),f(E,p),f(E,N),f(E,U),f(E,z),f(E,C),f(E,Ee),B.m(E,null),f(I,Ce),f(I,D),f(D,X),f(D,Ie),f(D,De),f(D,Le),f(D,R),f(D,Te),P.m(D,null),l[11](I),L(i,ue,h),L(i,Y,h),f(Y,G),f(G,q),f(q,ee),f(q,$e),v&&v.m(q,null),f(G,Ve),f(G,O),f(O,te),f(O,Se),H[T].m(O,null),re=!0,Ne||(qe=[ne(s,"input",l[6]),ne(u,"click",l[7])],Ne=!0)},p(i,h){i[0]?w?w.p(i,h):(w=Qe(i),w.c(),w.m(e.parentNode,e)):w&&(w.d(1),w=null),i[1]?y?y.p(i,h):(y=We(i),y.c(),y.m(a.parentNode,a)):y&&(y.d(1),y=null),(!re||h&16&&t!==(t=i[4].name)&&s.value!==t)&&(s.value=t);const Z={};!le&&h&16&&(le=!0,Z.markdown=i[4].description,ve(()=>le=!1)),S.$set(Z),ce===(ce=je(i))&&B?B.p(i,h):(B.d(1),B=ce(i),B&&(B.c(),B.m(E,null))),fe===(fe=Fe(i))&&P?P.p(i,h):(P.d(1),P=fe(i),P&&(P.c(),P.m(D,null))),i[4]&&i[4].stats?v?(v.p(i,h),h&16&&V(v,1)):(v=Xe(i),v.c(),V(v,1),v.m(q,null)):v&&(Pe(),M(v,1,1,()=>{v=null}),Be());let se=T;T=Ge(i),T===se?H[T].p(i,h):(Pe(),M(H[se],1,1,()=>{H[se]=null}),Be(),$=H[T],$?$.p(i,h):($=H[T]=ze[T](i),$.c()),V($,1),$.m(O,null))},i(i){re||(V(S.$$.fragment,i),V(v),V($),re=!0)},o(i){M(S.$$.fragment,i),M(v),M($),re=!1},d(i){i&&(m(e),m(a),m(n),m(ue),m(Y)),w&&w.d(i),y&&y.d(i),ye(S),B.d(),P.d(),l[11](null),v&&v.d(),H[T].d(),Ne=!1,lt(qe)}}}function Qe(l){let e,a,n;return{c(){e=d("div"),a=d("p"),n=Ze(l[0]),this.h()},l(r){e=_(r,"DIV",{class:!0});var s=k(e);a=_(s,"P",{});var t=k(a);n=xe(t,l[0]),t.forEach(m),s.forEach(m),this.h()},h(){o(e,"class","success alert svelte-nbk2og")},m(r,s){L(r,e,s),f(e,a),f(a,n)},p(r,s){s&1&&et(n,r[0])},d(r){r&&m(e)}}}function We(l){let e,a,n;return{c(){e=d("div"),a=d("p"),n=Ze(l[1]),this.h()},l(r){e=_(r,"DIV",{class:!0});var s=k(e);a=_(s,"P",{});var t=k(a);n=xe(t,l[1]),t.forEach(m),s.forEach(m),this.h()},h(){o(e,"class","error alert svelte-nbk2og")},m(r,s){L(r,e,s),f(e,a),f(a,n)},p(r,s){s&2&&et(n,r[1])},d(r){r&&m(e)}}}function ft(l){let e,a="Upload Icon",n,r;return{c(){e=d("button"),e.textContent=a},l(s){e=_(s,"BUTTON",{"data-svelte-h":!0}),x(e)!=="svelte-qnmkvj"&&(e.textContent=a)},m(s,t){L(s,e,t),n||(r=ne(e,"click",l[8]),n=!0)},p:Ye,d(s){s&&m(e),n=!1,r()}}}function dt(l){let e,a,n,r;return{c(){e=d("img"),this.h()},l(s){e=_(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){he(e.src,a=l[4].icon)||o(e,"src",a),o(e,"alt",""),o(e,"class","svelte-nbk2og")},m(s,t){L(s,e,t),n||(r=ne(e,"click",l[8]),n=!0)},p(s,t){t&16&&!he(e.src,a=s[4].icon)&&o(e,"src",a)},d(s){s&&m(e),n=!1,r()}}}function _t(l){let e,a="Upload Refsheet",n,r;return{c(){e=d("button"),e.textContent=a,this.h()},l(s){e=_(s,"BUTTON",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-oeurci"&&(e.textContent=a),this.h()},h(){o(e,"class","svelte-nbk2og")},m(s,t){L(s,e,t),n||(r=ne(e,"click",l[8]),n=!0)},p:Ye,d(s){s&&m(e),n=!1,r()}}}function mt(l){let e,a,n,r;return{c(){e=d("img"),this.h()},l(s){e=_(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){he(e.src,a=l[4].refsheet)||o(e,"src",a),o(e,"alt",""),o(e,"class","svelte-nbk2og")},m(s,t){L(s,e,t),n||(r=ne(e,"click",l[8]),n=!0)},p(s,t){t&16&&!he(e.src,a=s[4].refsheet)&&o(e,"src",a)},d(s){s&&m(e),n=!1,r()}}}function Xe(l){let e,a,n;function r(t){l[12](t)}let s={dataToSet:l[4].stats};return l[2]!==void 0&&(s.data=l[2]),e=new ut({props:s}),oe.push(()=>ge(e,"data",r)),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,c){we(e,t,c),n=!0},p(t,c){const u={};c&16&&(u.dataToSet=t[4].stats),!a&&c&4&&(a=!0,u.data=t[2],ve(()=>a=!1)),e.$set(u)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ye(e,t)}}}function pt(l){let e,a,n;function r(t){l[14](t)}let s={placeholder:"Add keywords"};return l[3]!==void 0&&(s.keywordsList=l[3]),e=new tt({props:s}),oe.push(()=>ge(e,"keywordsList",r)),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,c){we(e,t,c),n=!0},p(t,c){const u={};!a&&c&8&&(a=!0,u.keywordsList=t[3],ve(()=>a=!1)),e.$set(u)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ye(e,t)}}}function ht(l){let e,a,n;function r(t){l[13](t)}let s={placeholder:"Add keywords",tagsToSet:l[4].tags};return l[3]!==void 0&&(s.keywordsList=l[3]),e=new tt({props:s}),oe.push(()=>ge(e,"keywordsList",r)),{c(){be(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,c){we(e,t,c),n=!0},p(t,c){const u={};c&16&&(u.tagsToSet=t[4].tags),!a&&c&8&&(a=!0,u.keywordsList=t[3],ve(()=>a=!1)),e.$set(u)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ye(e,t)}}}function vt(l){let e,a,n,r,s;document.title=e="Editing "+(l[4]&&l[4].name||"a character");let t=l[4]&&Ke(l);return{c(){a=g(),n=d("main"),r=d("div"),t&&t.c(),this.h()},l(c){rt("svelte-624mu2",document.head).forEach(m),a=b(c),n=_(c,"MAIN",{});var Q=k(n);r=_(Q,"DIV",{class:!0});var A=k(r);t&&t.l(A),A.forEach(m),Q.forEach(m),this.h()},h(){o(r,"class","container")},m(c,u){L(c,a,u),L(c,n,u),f(n,r),t&&t.m(r,null),s=!0},p(c,[u]){(!s||u&16)&&e!==(e="Editing "+(c[4]&&c[4].name||"a character"))&&(document.title=e),c[4]?t?(t.p(c,u),u&16&&V(t,1)):(t=Ke(c),t.c(),V(t,1),t.m(r,null)):t&&(Pe(),M(t,1,1,()=>{t=null}),Be())},i(c){s||(V(t),s=!0)},o(c){M(t),s=!1},d(c){c&&(m(a),m(n)),t&&t.d()}}}function gt(l,e,a){let{data:n}=e,r="",s="",t,c=[],u=null;(async()=>{try{a(4,u=await Ue.getCharacter(n.id))}catch{await Je("/discover")}})();function Q(p){a(4,u.name=p.target.value,u)}let A;function S(p){u&&Ue.updateCharacter({...u,tags:c,stats:t}).then(async F=>{await Je(`/${u.code}`)}).catch(F=>{console.log(F)})}const le=async p=>new Promise((F,N)=>{const U=new FileReader;U.readAsDataURL(p),U.onload=()=>F(U.result),U.onerror=z=>N(z)});function ae(p){let N=p.target.parentNode.querySelector("input[type='file']");N.click(),N.addEventListener("change",async()=>{let U=N.files[0];p.target.src=await le(U);let z=new FormData;z.set("image",U);try{let C=await Ue.upload(z);C&&(N.id.includes("icon")?a(4,u.icon=C,u):N.id.includes("refsheet")&&a(4,u.refsheet=C,u))}catch(C){console.log(C)}})}function W(p){l.$$.not_equal(u.description,p)&&(u.description=p,a(4,u))}function ie(p){oe[p?"unshift":"push"](()=>{A=p,a(5,A)})}function j(p){t=p,a(2,t)}function I(p){c=p,a(3,c)}function E(p){c=p,a(3,c)}return l.$$set=p=>{"data"in p&&a(9,n=p.data)},[r,s,t,c,u,A,Q,S,ae,n,W,ie,j,I,E]}class Dt extends at{constructor(e){super(),it(this,e,gt,vt,nt,{data:9})}}export{Dt as component,It as universal};
