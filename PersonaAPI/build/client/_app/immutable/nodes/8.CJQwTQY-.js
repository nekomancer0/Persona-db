import{s as R,c as G,o as J,b as K,n as q}from"../chunks/scheduler.BWOwpdHh.js";import{S as Q,i as W,e as p,s as D,v as X,c as h,d as c,m as H,a as P,n as L,w as v,q as k,b as C,f as x,h as Z,t as U,g as $,j as ee,l as te,p as le,u as ae,H as ne,B as re,k as Y,o as O,r as se,x as V,y as oe}from"../chunks/index.MrXRJrN0.js";import{h as ie,u as ce,e as j}from"../chunks/each.MqN4OFCs.js";import{g as ue}from"../chunks/globals.D0QH3NT1.js";import{g as fe}from"../chunks/entry.Cbhw0m9C.js";import{U as de}from"../chunks/UserProfile.Bpe4Ez77.js";import{u as me}from"../chunks/stores.B2cYib0m.js";import{a as F}from"../chunks/api.DB7-yUPC.js";const{document:A}=ue;function S(o,l,n){const t=o.slice();return t[9]=l[n],t}function pe(o){let l,n="You are not connected",t,e,r='<li><a href="/login">Login</a></li>';return{c(){l=p("p"),l.textContent=n,t=D(),e=p("ul"),e.innerHTML=r},l(a){l=h(a,"P",{"data-svelte-h":!0}),L(l)!=="svelte-xpjzu7"&&(l.textContent=n),t=H(a),e=h(a,"UL",{"data-svelte-h":!0}),L(e)!=="svelte-ejvyc0"&&(e.innerHTML=r)},m(a,d){C(a,l,d),C(a,t,d),C(a,e,d)},p:q,i:q,o:q,d(a){a&&(c(l),c(t),c(e))}}}function he(o){let l,n,t,e,r,a,d='<h2>Update</h2> <div class="controls svelte-7dbtqd"><div class="control svelte-7dbtqd"><label for="file" class="svelte-7dbtqd">Avatar :</label> <input type="file" class="input-file" name="file" id="file" accept="image/png, image/jpeg, image/gif"/></div> <div class="control svelte-7dbtqd"><label for="file" class="svelte-7dbtqd">Username :</label> <input type="text" name="username" id="username" placeholder="Set a new username" autocomplete="off"/></div></div> <button id="submit" class="svelte-7dbtqd">Update</button>',y,b,g,T="My characters",m,u,w,_=o[0]&&z(o),f=o[1]&&N(o);e=new de({props:{user:o[3]}});let E={ctx:o,current:null,token:null,hasCatch:!1,pending:be,then:ve,catch:_e,value:8};return ie(o[4](),E),{c(){_&&_.c(),l=D(),f&&f.c(),n=D(),t=p("div"),ee(e.$$.fragment),r=D(),a=p("form"),a.innerHTML=d,y=D(),b=p("div"),g=p("h2"),g.textContent=T,m=D(),u=p("div"),E.block.c(),this.h()},l(s){_&&_.l(s),l=H(s),f&&f.l(s),n=H(s),t=h(s,"DIV",{class:!0});var i=P(t);te(e.$$.fragment,i),r=H(i),a=h(i,"FORM",{id:!0,class:!0,"data-svelte-h":!0}),L(a)!=="svelte-111zpai"&&(a.innerHTML=d),i.forEach(c),y=H(s),b=h(s,"DIV",{class:!0});var M=P(b);g=h(M,"H2",{"data-svelte-h":!0}),L(g)!=="svelte-l0qx6s"&&(g.textContent=T),m=H(M),u=h(M,"DIV",{class:!0});var I=P(u);E.block.l(I),I.forEach(c),M.forEach(c),this.h()},h(){v(a,"id","update-form"),v(a,"class","box svelte-7dbtqd"),v(t,"class","inline svelte-7dbtqd"),v(u,"class","characters"),v(b,"class","my-characters-box svelte-7dbtqd")},m(s,i){_&&_.m(s,i),C(s,l,i),f&&f.m(s,i),C(s,n,i),C(s,t,i),le(e,t,null),k(t,r),k(t,a),o[5](a),C(s,y,i),C(s,b,i),k(b,g),k(b,m),k(b,u),E.block.m(u,E.anchor=null),E.mount=()=>u,E.anchor=null,w=!0},p(s,i){o=s,o[0]?_?_.p(o,i):(_=z(o),_.c(),_.m(l.parentNode,l)):_&&(_.d(1),_=null),o[1]?f?f.p(o,i):(f=N(o),f.c(),f.m(n.parentNode,n)):f&&(f.d(1),f=null);const M={};i&8&&(M.user=o[3]),e.$set(M),ce(E,o,i)},i(s){w||(U(e.$$.fragment,s),w=!0)},o(s){x(e.$$.fragment,s),w=!1},d(s){s&&(c(l),c(n),c(t),c(y),c(b)),_&&_.d(s),f&&f.d(s),ae(e),o[5](null),E.block.d(),E.token=null,E=null}}}function z(o){let l,n,t;return{c(){l=p("div"),n=p("p"),t=new ne(!1),this.h()},l(e){l=h(e,"DIV",{class:!0});var r=P(l);n=h(r,"P",{});var a=P(n);t=re(a,!1),a.forEach(c),r.forEach(c),this.h()},h(){t.a=null,v(l,"class","success alert svelte-7dbtqd")},m(e,r){C(e,l,r),k(l,n),t.m(o[0],n)},p(e,r){r&1&&t.p(e[0])},d(e){e&&c(l)}}}function N(o){let l,n,t;return{c(){l=p("div"),n=p("p"),t=Y(o[1]),this.h()},l(e){l=h(e,"DIV",{class:!0});var r=P(l);n=h(r,"P",{});var a=P(n);t=O(a,o[1]),a.forEach(c),r.forEach(c),this.h()},h(){v(l,"class","error alert svelte-7dbtqd")},m(e,r){C(e,l,r),k(l,n),k(n,t)},p(e,r){r&2&&se(t,e[1])},d(e){e&&c(l)}}}function _e(o){return{c:q,l:q,m:q,p:q,d:q}}function ve(o){let l,n=j(o[8]),t=[];for(let e=0;e<n.length;e+=1)t[e]=B(S(o,n,e));return{c(){for(let e=0;e<t.length;e+=1)t[e].c();l=V()},l(e){for(let r=0;r<t.length;r+=1)t[r].l(e);l=V()},m(e,r){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,r);C(e,l,r)},p(e,r){if(r&16){n=j(e[8]);let a;for(a=0;a<n.length;a+=1){const d=S(e,n,a);t[a]?t[a].p(d,r):(t[a]=B(d),t[a].c(),t[a].m(l.parentNode,l))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},d(e){e&&c(l),oe(t,e)}}}function B(o){let l,n=o[9].name+"",t;return{c(){l=p("a"),t=Y(n),this.h()},l(e){l=h(e,"A",{href:!0});var r=P(l);t=O(r,n),r.forEach(c),this.h()},h(){v(l,"href",`/${o[9].code}`)},m(e,r){C(e,l,r),k(l,t)},p:q,d(e){e&&c(l)}}}function be(o){return{c:q,l:q,m:q,p:q,d:q}}function ge(o){let l,n,t,e,r,a,d,y,b,g="My Profile",T,m,u,w;const _=[he,pe],f=[];function E(s,i){return s[3]?0:1}return m=E(o),u=f[m]=_[m](o),{c(){l=p("meta"),n=p("meta"),t=p("meta"),e=p("meta"),r=p("meta"),a=D(),d=p("main"),y=p("div"),b=p("h1"),b.textContent=g,T=D(),u.c(),this.h()},l(s){const i=X("svelte-103wdwc",A.head);l=h(i,"META",{name:!0,content:!0}),n=h(i,"META",{name:!0,content:!0}),t=h(i,"META",{property:!0,content:!0}),e=h(i,"META",{property:!0,content:!0}),r=h(i,"META",{property:!0,content:!0}),i.forEach(c),a=H(s),d=h(s,"MAIN",{});var M=P(d);y=h(M,"DIV",{class:!0});var I=P(y);b=h(I,"H1",{"data-svelte-h":!0}),L(b)!=="svelte-bjixez"&&(b.textContent=g),T=H(I),u.l(I),I.forEach(c),M.forEach(c),this.h()},h(){A.title="Persona - My Profile",v(l,"name","author"),v(l,"content","Persona DB - My Profile"),v(n,"name","description"),v(n,"content","Find and host any original characters"),v(t,"property","og:title"),v(t,"content","Persona DB"),v(e,"property","og:description"),v(e,"content","Find and host any original characters"),v(r,"property","og:image"),v(r,"content","https://persona-db.xyz/favicon.png"),v(y,"class","container")},m(s,i){k(A.head,l),k(A.head,n),k(A.head,t),k(A.head,e),k(A.head,r),C(s,a,i),C(s,d,i),k(d,y),k(y,b),k(y,T),f[m].m(y,null),w=!0},p(s,[i]){let M=m;m=E(s),m===M?f[m].p(s,i):($(),x(f[M],1,1,()=>{f[M]=null}),Z(),u=f[m],u?u.p(s,i):(u=f[m]=_[m](s),u.c()),U(u,1),u.m(y,null))},i(s){w||(U(u),w=!0)},o(s){x(u),w=!1},d(s){s&&(c(a),c(d)),c(l),c(n),c(t),c(e),c(r),f[m].d()}}}function ke(o,l,n){let t;G(o,me,g=>n(3,t=g));let e="",r="";function a(g){n(1,r=g),setTimeout(()=>{n(1,r="")},3e3)}let d;J(()=>{if(!d)return;d.querySelector("#submit").addEventListener("click",async T=>{let m=new FormData(d);if(!m.get("username")&&!m.get("file"))a("You must provide username or avatar");else try{let u=await F.updateMe(m);n(0,e=u.message),n(1,r=""),await fe("/")}catch(u){n(0,e=""),a(u.response.message),console.log(u);let w=document.querySelector("#username");w.value=""}})});async function y(){return(await F.getCharacters()).filter(T=>T.ownerId===t._id)}function b(g){K[g?"unshift":"push"](()=>{d=g,n(2,d)})}return[e,r,d,t,y,b]}class De extends Q{constructor(l){super(),W(this,l,ke,ge,R,{})}}export{De as component};
