import{s as $,c as G,o as J,b as K,n as q}from"../chunks/scheduler.BWOwpdHh.js";import{S as Q,i as W,e as h,s as D,v as X,c as p,d as c,m as H,a as P,n as x,w as v,q as y,b as C,f as L,h as Z,t as U,g as ee,j as te,l as le,p as ae,u as ne,H as re,B as se,k as Y,o as O,r as oe,x as V,y as ie}from"../chunks/index.MrXRJrN0.js";import{h as ce,u as ue,e as j}from"../chunks/each.MqN4OFCs.js";import{g as fe}from"../chunks/globals.D0QH3NT1.js";import{g as de}from"../chunks/entry.FLlzqz6F.js";import{a as F,r as S,u as me}from"../chunks/stores.q1PpW4Db.js";import{U as he}from"../chunks/UserProfile.g5fhnWqW.js";const{document:A}=fe;function z(o,l,n){const t=o.slice();return t[9]=l[n],t}function pe(o){let l,n="You are not connected",t,e,r='<li><a href="/login">Login</a></li>';return{c(){l=h("p"),l.textContent=n,t=D(),e=h("ul"),e.innerHTML=r},l(a){l=p(a,"P",{"data-svelte-h":!0}),x(l)!=="svelte-xpjzu7"&&(l.textContent=n),t=H(a),e=p(a,"UL",{"data-svelte-h":!0}),x(e)!=="svelte-ejvyc0"&&(e.innerHTML=r)},m(a,d){C(a,l,d),C(a,t,d),C(a,e,d)},p:q,i:q,o:q,d(a){a&&(c(l),c(t),c(e))}}}function _e(o){let l,n,t,e,r,a,d='<h2>Update</h2> <div class="controls svelte-7dbtqd"><div class="control svelte-7dbtqd"><label for="file" class="svelte-7dbtqd">Avatar :</label> <input type="file" class="input-file" name="file" id="file" accept="image/png, image/jpeg, image/gif"/></div> <div class="control svelte-7dbtqd"><label for="file" class="svelte-7dbtqd">Username :</label> <input type="text" name="username" id="username" placeholder="Set a new username" autocomplete="off"/></div></div> <button id="submit" class="svelte-7dbtqd">Update</button>',k,b,g,T="My characters",m,f,w,_=o[0]&&N(o),u=o[1]&&B(o);e=new he({props:{user:o[3]}});let E={ctx:o,current:null,token:null,hasCatch:!1,pending:ge,then:be,catch:ve,value:8};return ce(o[4](),E),{c(){_&&_.c(),l=D(),u&&u.c(),n=D(),t=h("div"),te(e.$$.fragment),r=D(),a=h("form"),a.innerHTML=d,k=D(),b=h("div"),g=h("h2"),g.textContent=T,m=D(),f=h("div"),E.block.c(),this.h()},l(s){_&&_.l(s),l=H(s),u&&u.l(s),n=H(s),t=p(s,"DIV",{class:!0});var i=P(t);le(e.$$.fragment,i),r=H(i),a=p(i,"FORM",{id:!0,class:!0,"data-svelte-h":!0}),x(a)!=="svelte-111zpai"&&(a.innerHTML=d),i.forEach(c),k=H(s),b=p(s,"DIV",{class:!0});var M=P(b);g=p(M,"H2",{"data-svelte-h":!0}),x(g)!=="svelte-l0qx6s"&&(g.textContent=T),m=H(M),f=p(M,"DIV",{class:!0});var I=P(f);E.block.l(I),I.forEach(c),M.forEach(c),this.h()},h(){v(a,"id","update-form"),v(a,"class","box svelte-7dbtqd"),v(t,"class","inline svelte-7dbtqd"),v(f,"class","characters"),v(b,"class","my-characters-box svelte-7dbtqd")},m(s,i){_&&_.m(s,i),C(s,l,i),u&&u.m(s,i),C(s,n,i),C(s,t,i),ae(e,t,null),y(t,r),y(t,a),o[5](a),C(s,k,i),C(s,b,i),y(b,g),y(b,m),y(b,f),E.block.m(f,E.anchor=null),E.mount=()=>f,E.anchor=null,w=!0},p(s,i){o=s,o[0]?_?_.p(o,i):(_=N(o),_.c(),_.m(l.parentNode,l)):_&&(_.d(1),_=null),o[1]?u?u.p(o,i):(u=B(o),u.c(),u.m(n.parentNode,n)):u&&(u.d(1),u=null);const M={};i&8&&(M.user=o[3]),e.$set(M),ue(E,o,i)},i(s){w||(U(e.$$.fragment,s),w=!0)},o(s){L(e.$$.fragment,s),w=!1},d(s){s&&(c(l),c(n),c(t),c(k),c(b)),_&&_.d(s),u&&u.d(s),ne(e),o[5](null),E.block.d(),E.token=null,E=null}}}function N(o){let l,n,t;return{c(){l=h("div"),n=h("p"),t=new re(!1),this.h()},l(e){l=p(e,"DIV",{class:!0});var r=P(l);n=p(r,"P",{});var a=P(n);t=se(a,!1),a.forEach(c),r.forEach(c),this.h()},h(){t.a=null,v(l,"class","success alert svelte-7dbtqd")},m(e,r){C(e,l,r),y(l,n),t.m(o[0],n)},p(e,r){r&1&&t.p(e[0])},d(e){e&&c(l)}}}function B(o){let l,n,t;return{c(){l=h("div"),n=h("p"),t=Y(o[1]),this.h()},l(e){l=p(e,"DIV",{class:!0});var r=P(l);n=p(r,"P",{});var a=P(n);t=O(a,o[1]),a.forEach(c),r.forEach(c),this.h()},h(){v(l,"class","error alert svelte-7dbtqd")},m(e,r){C(e,l,r),y(l,n),y(n,t)},p(e,r){r&2&&oe(t,e[1])},d(e){e&&c(l)}}}function ve(o){return{c:q,l:q,m:q,p:q,d:q}}function be(o){let l,n=j(o[8]),t=[];for(let e=0;e<n.length;e+=1)t[e]=R(z(o,n,e));return{c(){for(let e=0;e<t.length;e+=1)t[e].c();l=V()},l(e){for(let r=0;r<t.length;r+=1)t[r].l(e);l=V()},m(e,r){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,r);C(e,l,r)},p(e,r){if(r&16){n=j(e[8]);let a;for(a=0;a<n.length;a+=1){const d=z(e,n,a);t[a]?t[a].p(d,r):(t[a]=R(d),t[a].c(),t[a].m(l.parentNode,l))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},d(e){e&&c(l),ie(t,e)}}}function R(o){let l,n=o[9].name+"",t;return{c(){l=h("a"),t=Y(n),this.h()},l(e){l=p(e,"A",{href:!0});var r=P(l);t=O(r,n),r.forEach(c),this.h()},h(){v(l,"href",`/${o[9].code}`)},m(e,r){C(e,l,r),y(l,t)},p:q,d(e){e&&c(l)}}}function ge(o){return{c:q,l:q,m:q,p:q,d:q}}function ye(o){let l,n,t,e,r,a,d,k,b,g="My Profile",T,m,f,w;const _=[_e,pe],u=[];function E(s,i){return s[3]?0:1}return m=E(o),f=u[m]=_[m](o),{c(){l=h("meta"),n=h("meta"),t=h("meta"),e=h("meta"),r=h("meta"),a=D(),d=h("main"),k=h("div"),b=h("h1"),b.textContent=g,T=D(),f.c(),this.h()},l(s){const i=X("svelte-103wdwc",A.head);l=p(i,"META",{name:!0,content:!0}),n=p(i,"META",{name:!0,content:!0}),t=p(i,"META",{property:!0,content:!0}),e=p(i,"META",{property:!0,content:!0}),r=p(i,"META",{property:!0,content:!0}),i.forEach(c),a=H(s),d=p(s,"MAIN",{});var M=P(d);k=p(M,"DIV",{class:!0});var I=P(k);b=p(I,"H1",{"data-svelte-h":!0}),x(b)!=="svelte-bjixez"&&(b.textContent=g),T=H(I),f.l(I),I.forEach(c),M.forEach(c),this.h()},h(){A.title="Persona - My Profile",v(l,"name","author"),v(l,"content","Persona DB - My Profile"),v(n,"name","description"),v(n,"content","Find and host any original characters"),v(t,"property","og:title"),v(t,"content","Persona DB"),v(e,"property","og:description"),v(e,"content","Find and host any original characters"),v(r,"property","og:image"),v(r,"content","https://persona-db.xyz/favicon.png"),v(k,"class","container")},m(s,i){y(A.head,l),y(A.head,n),y(A.head,t),y(A.head,e),y(A.head,r),C(s,a,i),C(s,d,i),y(d,k),y(k,b),y(k,T),u[m].m(k,null),w=!0},p(s,[i]){let M=m;m=E(s),m===M?u[m].p(s,i):(ee(),L(u[M],1,1,()=>{u[M]=null}),Z(),f=u[m],f?f.p(s,i):(f=u[m]=_[m](s),f.c()),U(f,1),f.m(k,null))},i(s){w||(U(f),w=!0)},o(s){L(f),w=!1},d(s){s&&(c(a),c(d)),c(l),c(n),c(t),c(e),c(r),u[m].d()}}}function ke(o,l,n){let t;G(o,me,g=>n(3,t=g));let e="",r="";function a(g){n(1,r=g),setTimeout(()=>{n(1,r="")},3e3)}let d;J(()=>{if(!d)return;d.querySelector("#submit").addEventListener("click",async T=>{let m=new FormData(d);if(!m.get("username")&&!m.get("file"))a("You must provide username or avatar");else try{let f=await F.put(`${S}/users`,m);n(0,e=f.data.message),n(1,r=""),await de("/")}catch(f){n(0,e=""),a(f.response.data.message);let w=document.querySelector("#username");w.value=""}})});async function k(){return(await F.get(`${S}/characters`)).data.filter(m=>m.ownerId===t._id)}function b(g){K[g?"unshift":"push"](()=>{d=g,n(2,d)})}return[e,r,d,t,k,b]}class De extends Q{constructor(l){super(),W(this,l,ke,ye,$,{})}}export{De as component};
