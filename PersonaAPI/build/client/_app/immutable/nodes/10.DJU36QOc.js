import{s as ue,o as fe,n as i}from"../chunks/scheduler.BWOwpdHh.js";import{S as he,i as _e,e as d,s as R,k as Q,v as de,c as m,d as u,m as T,a as $,o as W,n as ee,w as _,q as f,b as P,r as me,t as M,f as U,x as S,g as pe,h as ge,y as ie,j as ke,l as ve,p as be,u as ye}from"../chunks/index.MrXRJrN0.js";import{h as te,u as ne,e as j}from"../chunks/each.MqN4OFCs.js";import{a as le,r as oe}from"../chunks/stores.q1PpW4Db.js";import{P as Ee}from"../chunks/PartialUser.D7LCOZEA.js";function re(r,l,o){const e=r.slice();return e[4]=l[o],e}function ae(r,l,o){const e=r.slice();return e[8]=l[o],e}function $e(r){return{c:i,l:i,m:i,p:i,i,o:i,d:i}}function we(r){let l,o,e=r[7].length&&Ce(r);return{c(){e&&e.c(),l=S()},l(t){e&&e.l(t),l=S()},m(t,s){e&&e.m(t,s),P(t,l,s),o=!0},p(t,s){t[7].length&&e.p(t,s)},i(t){o||(M(e),o=!0)},o(t){U(e),o=!1},d(t){t&&u(l),e&&e.d(t)}}}function Ce(r){let l,o,e=j(r[7]),t=[];for(let n=0;n<e.length;n+=1)t[n]=ce(ae(r,e,n));const s=n=>U(t[n],1,1,()=>{t[n]=null});return{c(){for(let n=0;n<t.length;n+=1)t[n].c();l=S()},l(n){for(let a=0;a<t.length;a+=1)t[a].l(n);l=S()},m(n,a){for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(n,a);P(n,l,a),o=!0},p(n,a){if(a&2){e=j(n[7]);let c;for(c=0;c<e.length;c+=1){const g=ae(n,e,c);t[c]?(t[c].p(g,a),M(t[c],1)):(t[c]=ce(g),t[c].c(),M(t[c],1),t[c].m(l.parentNode,l))}for(pe(),c=e.length;c<t.length;c+=1)s(c);ge()}},i(n){if(!o){for(let a=0;a<e.length;a+=1)M(t[a]);o=!0}},o(n){t=t.filter(Boolean);for(let a=0;a<t.length;a+=1)U(t[a]);o=!1},d(n){n&&u(l),ie(t,n)}}}function ce(r){let l,o;return l=new Ee({props:{user:r[8]}}),{c(){ke(l.$$.fragment)},l(e){ve(l.$$.fragment,e)},m(e,t){be(l,e,t),o=!0},p:i,i(e){o||(M(l.$$.fragment,e),o=!0)},o(e){U(l.$$.fragment,e),o=!1},d(e){ye(l,e)}}}function Se(r){return{c:i,l:i,m:i,p:i,i,o:i,d:i}}function Ie(r){return{c:i,l:i,m:i,p:i,d:i}}function Pe(r){let l,o=r[3].length&&qe(r);return{c(){o&&o.c(),l=S()},l(e){o&&o.l(e),l=S()},m(e,t){o&&o.m(e,t),P(e,l,t)},p(e,t){e[3].length&&o.p(e,t)},d(e){e&&u(l),o&&o.d(e)}}}function qe(r){let l,o=j(r[3]),e=[];for(let t=0;t<o.length;t+=1)e[t]=se(re(r,o,t));return{c(){for(let t=0;t<e.length;t+=1)e[t].c();l=S()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);l=S()},m(t,s){for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(t,s);P(t,l,s)},p(t,s){if(s&4){o=j(t[3]);let n;for(n=0;n<o.length;n+=1){const a=re(t,o,n);e[n]?e[n].p(a,s):(e[n]=se(a),e[n].c(),e[n].m(l.parentNode,l))}for(;n<e.length;n+=1)e[n].d(1);e.length=o.length}},d(t){t&&u(l),ie(e,t)}}}function se(r){let l,o,e=r[4].name+"",t;return{c(){l=d("li"),o=d("a"),t=Q(e),this.h()},l(s){l=m(s,"LI",{});var n=$(l);o=m(n,"A",{href:!0});var a=$(o);t=W(a,e),a.forEach(u),n.forEach(u),this.h()},h(){_(o,"href",`/${r[4].code}`)},m(s,n){P(s,l,n),f(l,o),f(o,t)},p:i,d(s){s&&u(l)}}}function Ae(r){return{c:i,l:i,m:i,p:i,d:i}}function Me(r){let l,o,e,t,s,n,a,c,g,b,w,z,D,V,F,C,y,q,X="Users",G,J,E,A,Y="Characters",K,I,p={ctx:r,current:null,token:null,hasCatch:!1,pending:Se,then:we,catch:$e,value:7,blocks:[,,,]};te(r[1](),p);let k={ctx:r,current:null,token:null,hasCatch:!1,pending:Ae,then:Pe,catch:Ie,value:3};return te(r[2](),k),{c(){l=d("meta"),o=d("meta"),t=d("meta"),s=d("meta"),a=d("meta"),c=R(),g=d("main"),b=d("div"),w=d("h1"),z=Q("Searching "),D=d("i"),V=Q(r[0]),F=R(),C=d("div"),y=d("div"),q=d("h2"),q.textContent=X,G=R(),p.block.c(),J=R(),E=d("div"),A=d("h2"),A.textContent=Y,K=R(),k.block.c(),this.h()},l(v){const h=de("svelte-1q82o1r",document.head);l=m(h,"META",{name:!0,content:!0}),o=m(h,"META",{name:!0,content:!0}),t=m(h,"META",{property:!0,content:!0}),s=m(h,"META",{property:!0,content:!0}),a=m(h,"META",{property:!0,content:!0}),h.forEach(u),c=T(v),g=m(v,"MAIN",{});var x=$(g);b=m(x,"DIV",{class:!0});var B=$(b);w=m(B,"H1",{});var O=$(w);z=W(O,"Searching "),D=m(O,"I",{});var Z=$(D);V=W(Z,r[0]),Z.forEach(u),O.forEach(u),F=T(B),C=m(B,"DIV",{class:!0});var H=$(C);y=m(H,"DIV",{class:!0});var N=$(y);q=m(N,"H2",{"data-svelte-h":!0}),ee(q)!=="svelte-owdh1y"&&(q.textContent=X),G=T(N),p.block.l(N),N.forEach(u),J=T(H),E=m(H,"DIV",{class:!0});var L=$(E);A=m(L,"H2",{"data-svelte-h":!0}),ee(A)!=="svelte-19nbxqm"&&(A.textContent=Y),K=T(L),k.block.l(L),L.forEach(u),H.forEach(u),B.forEach(u),x.forEach(u),this.h()},h(){document.title="Persona - Search",_(l,"name","author"),_(l,"content","Persona DB - Search"),_(o,"name","description"),_(o,"content",e="Search results for "+r[0]),_(t,"property","og:title"),_(t,"content","Persona DB - Search"),_(s,"property","og:description"),_(s,"content",n="Search results for "+r[0]),_(a,"property","og:image"),_(a,"content","https://persona-db.xyz/favicon.png"),_(y,"class","users"),_(E,"class","characters"),_(C,"class","inline svelte-kkud9r"),_(b,"class","container")},m(v,h){f(document.head,l),f(document.head,o),f(document.head,t),f(document.head,s),f(document.head,a),P(v,c,h),P(v,g,h),f(g,b),f(b,w),f(w,z),f(w,D),f(D,V),f(b,F),f(b,C),f(C,y),f(y,q),f(y,G),p.block.m(y,p.anchor=null),p.mount=()=>y,p.anchor=null,f(C,J),f(C,E),f(E,A),f(E,K),k.block.m(E,k.anchor=null),k.mount=()=>E,k.anchor=null,I=!0},p(v,[h]){r=v,(!I||h&1&&e!==(e="Search results for "+r[0]))&&_(o,"content",e),(!I||h&1&&n!==(n="Search results for "+r[0]))&&_(s,"content",n),(!I||h&1)&&me(V,r[0]),ne(p,r,h),ne(k,r,h)},i(v){I||(M(p.block),I=!0)},o(v){for(let h=0;h<3;h+=1){const x=p.blocks[h];U(x)}I=!1},d(v){v&&(u(c),u(g)),u(l),u(o),u(t),u(s),u(a),p.block.d(),p.token=null,p=null,k.block.d(),k.token=null,k=null}}}function De(r,l,o){let e="";async function t(){let n=[],a=await le.get(`${oe}/users`);for(let c of a.data)c.username.includes(e)&&n.push(c);return n}async function s(){let n=[],a=await le.get(`${oe}/characters`);for(let c of a.data)if(c.name.includes(e))n.push(c);else{let g=!1,b=e.split(" ");for(let w of b)c.tags.includes(w)&&(g=!0);g&&n.push(c)}return n}return fe(async()=>{const n=new Proxy(new URLSearchParams(window.location.search),{get:(a,c)=>a.get(c)});if(!n.q){window.location.href="/";return}o(0,e=decodeURIComponent(n.q))}),[e,t,s]}class Be extends he{constructor(l){super(),_e(this,l,De,Me,ue,{})}}export{Be as component};
