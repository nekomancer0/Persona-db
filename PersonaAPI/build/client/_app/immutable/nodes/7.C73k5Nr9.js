import{s as U,n as T,o as V}from"../chunks/scheduler.BWOwpdHh.js";import{S as x,i as B,e as b,s as S,v as H,c as w,d as i,m as j,a as P,n as z,w as m,q as u,b as I,k as C,o as R,r as F}from"../chunks/index.MrXRJrN0.js";import{g as N}from"../chunks/globals.D0QH3NT1.js";import{a as L,r as D}from"../chunks/stores.q1PpW4Db.js";const{document:q}=N;function k(f){let t,a,o;return{c(){t=b("div"),a=b("p"),o=C(f[0]),this.h()},l(e){t=w(e,"DIV",{class:!0});var s=P(t);a=w(s,"P",{});var p=P(a);o=R(p,f[0]),p.forEach(i),s.forEach(i),this.h()},h(){m(t,"class","success alert svelte-m0q0fj")},m(e,s){I(e,t,s),u(t,a),u(a,o)},p(e,s){s&1&&F(o,e[0])},d(e){e&&i(t)}}}function A(f){let t,a,o;return{c(){t=b("div"),a=b("p"),o=C(f[1]),this.h()},l(e){t=w(e,"DIV",{class:!0});var s=P(t);a=w(s,"P",{});var p=P(a);o=R(p,f[1]),p.forEach(i),s.forEach(i),this.h()},h(){m(t,"class","error alert svelte-m0q0fj")},m(e,s){I(e,t,s),u(t,a),u(a,o)},p(e,s){s&2&&F(o,e[1])},d(e){e&&i(t)}}}function G(f){let t,a,o,e,s,p,d,l,y,_,h,g='<div class="full"><h1 class="svelte-m0q0fj">Login</h1> <form action="" method="post" id="login-form" class="box svelte-m0q0fj"><div class="control"><label for="username">Username</label> <br/><br/> <input type="text" name="username" id="username" placeholder="Username" autocomplete="off"/></div> <br/> <div class="control"><label for="password">Password</label><br/><br/> <input type="password" name="password" id="password" placeholder="Password"/></div> <br/> <button type="submit" class="svelte-m0q0fj">Log In</button></form></div> <div class="full"><h1 class="svelte-m0q0fj">Register</h1> <form action="" method="post" id="register-form" class="box svelte-m0q0fj"><div class="control"><label for="username">Username</label> <br/><br/> <input type="text" name="username" id="username" placeholder="Username" autocomplete="off"/></div> <br/> <div class="control"><label for="email">Email</label> <br/><br/> <input type="text" name="email" id="email" placeholder="Email" autocomplete="off"/></div> <br/> <div class="control"><label for="password">Password</label><br/><br/> <input type="password" name="password" id="password" placeholder="Password"/></div> <br/> <div class="control"><label for="repeat-password">Repeat Password</label><br/><br/> <input type="password" name="repeat-password" id="repeat-password" placeholder="Repeat Password"/></div> <br/> <button type="submit" class="register-btn svelte-m0q0fj">Create an account</button></form></div>',n=f[0]&&k(f),r=f[1]&&A(f);return{c(){t=b("meta"),a=b("meta"),o=b("meta"),e=b("meta"),s=b("meta"),p=S(),d=b("main"),l=b("div"),n&&n.c(),y=S(),r&&r.c(),_=S(),h=b("div"),h.innerHTML=g,this.h()},l(c){const v=H("svelte-pgu42o",q.head);t=w(v,"META",{name:!0,content:!0}),a=w(v,"META",{name:!0,content:!0}),o=w(v,"META",{property:!0,content:!0}),e=w(v,"META",{property:!0,content:!0}),s=w(v,"META",{property:!0,content:!0}),v.forEach(i),p=j(c),d=w(c,"MAIN",{});var M=P(d);l=w(M,"DIV",{class:!0});var E=P(l);n&&n.l(E),y=j(E),r&&r.l(E),_=j(E),h=w(E,"DIV",{class:!0,"data-svelte-h":!0}),z(h)!=="svelte-woqk6r"&&(h.innerHTML=g),E.forEach(i),M.forEach(i),this.h()},h(){q.title="Persona - Login",m(t,"name","author"),m(t,"content","Persona DB - Login & Register"),m(a,"name","description"),m(a,"content","Find and host any original characters"),m(o,"property","og:title"),m(o,"content","Persona DB - Login & Register"),m(e,"property","og:description"),m(e,"content","Find and host any original characters"),m(s,"property","og:image"),m(s,"content","https://persona-db.xyz/favicon.png"),m(h,"class","forms svelte-m0q0fj"),m(l,"class","container")},m(c,v){u(q.head,t),u(q.head,a),u(q.head,o),u(q.head,e),u(q.head,s),I(c,p,v),I(c,d,v),u(d,l),n&&n.m(l,null),u(l,y),r&&r.m(l,null),u(l,_),u(l,h)},p(c,[v]){c[0]?n?n.p(c,v):(n=k(c),n.c(),n.m(l,y)):n&&(n.d(1),n=null),c[1]?r?r.p(c,v):(r=A(c),r.c(),r.m(l,_)):r&&(r.d(1),r=null)},i:T,o:T,d(c){c&&(i(p),i(d)),i(t),i(a),i(o),i(e),i(s),n&&n.d(),r&&r.d()}}}function J(f,t,a){L.defaults.withCredentials=!0;let o="",e="";function s(d){a(1,e=d),setTimeout(()=>{a(1,e="")},3e3)}function p(d){a(0,o=d),setTimeout(()=>{a(0,o="")},3e3)}return V(()=>{let d=document.querySelector("#login-form");d.addEventListener("submit",async y=>{y.preventDefault();let _=d.querySelector("#username"),h=d.querySelector("#password");try{let g=await L.post(`${D}/users/login`,{username:_.value,password:h.value},{withCredentials:!0});p(g.data.message),window.location.href="/"}catch(g){s(g.response.data.message),console.log(g)}});let l=document.querySelector("#register-form");l.addEventListener("submit",async y=>{y.preventDefault();let _=l.querySelector("#username"),h=l.querySelector("#password"),g=l.querySelector("#email");if(l.querySelector("#repeat-password").value!==h.value)return s("Passwords don't match");try{let r=await L.post(`${D}/users`,{username:_.value,email:g.value,password:h.value},{withCredentials:!0});p(r.data.message),window.location.href="/"}catch(r){s(r.response.data.message),console.log(r)}})}),[o,e]}class X extends x{constructor(t){super(),B(this,t,J,G,U,{})}}export{X as component};
